# 物理式渲染技术

## 概述

本书总体介绍了物理式渲染技术(或称基于物理的渲染技术)的原理和实现。主要参考书为[Physically Based Rendering From Theory To Implementation 4ed(更新中)](pbrt4ed/pbrt4ed.md)

在本人有限的认知和能力下，文字尽量简单易懂。期望能在提高信息质量的同时，增加信息密度，减少阅读时间，降低理解难度，最终提高阅读效率和效果

### 阅读须知

1. 本文具有阅读门槛，读者需要先对计算机图形学，C++，大学数学，高中物理有所了解，本文章不会深入介绍相关基础知识
2. 本人默认读者具有国内理工科大学(或相当)的知识水平
3. 本文预设语境是计算机图形学，所有涉及名词和定义皆只在其下成立
4. 由于本人水平有限，若有错误，请联系我指正

### 什么是渲染？

用计算机把各种三维模型通过处理和计算，最终生成二维图像的过程。

其中，动画的本质就是足够快且连续地播放这些渲染后的图像，让人眼看上去在动。

### 什么是基于物理的渲染(即物理式渲染)?

为了使图片看上去更像照片拍出来的效果(更真实)，故基于物理学理论来渲染。英文缩写为pbr(Physically Based Rendering)。

要使图片看起来真实，最关键的因素就是利用现有物理理论，模拟光在现实中的传播过程和与物体之间的作用。

### 基于哪些物理学理论？

严格来讲，pbr的实现并不完全遵循物理学理论，而是根据人眼对图像有限的分辨能力和计算机的有限的计算能力做了折衷，主要理论如下

    - 光学：假设光沿直线传播，并且忽略光的波动性，关注光在真空或介质中传播现象，和光与不同物体之间的作用现象(比如散射，折射，反射)，一般来说，主要关注光的宏观尺度现象，忽略微观尺度现象，对应光学中的几何光学部分。
    - 辐射度量学: 光是辐射能的一种，衡量能量的传播和与物体的作用的过程中，能量的变化情况，这个能量后续会用来计算对应的颜色
    - 色度学： 描述光对应的颜色的各种特征
    - 光度学： 描述光的能量对应人眼看到的颜色情况

这些知识也会涉及到数学上的几何，线性代数，微积分，和概率论统计学知识。

本文讨论的pbr中，对这些物理相关理论的应用不深，读者只需了解高中物理知识，同时看得懂微积分公式即可。

关于成像原理，图形，屏幕相关请参考图形学书籍

### 什么是光线追踪(ray tracing)

光线追踪，即在计算机里模拟光线传播，和光线与物体交互的过程

对这个过程做处理的(软件或硬件)模块就叫做光线追踪器(ray tracer)

pbr主要就是利用光线追踪方法，来处理光相关的信息

### 如何实现pbr？

现实中拍摄照片或者人眼的观察，都是相机或人眼对观察的物体的光的信息进行了捕获和处理。要模拟真实情况，就可以根据在现实中观察或拍摄过程涉及到的事物进行概念抽象，转换为C++中的各种类。

本文用C++17面向对象的方式实现，前期代码会使用CPU计算，后期使用GPU计算。

代码方面采用递进式迭代方法，会从简单代码开始，逐步迭代到更复杂。前文的描述，会被后文所扩展

由于计算机性能有限且存在误差，需要对处理和计算过程做大量精简和优化。

一般来说，渲染的图片越真实，就需要更多的计算和处理，计算机的性能消耗就越大，渲染所需时间也越长。

## pbr系统介绍

本文主要描述的是基于whitted的光线追踪算法的pbr实现，主要用于离线渲染。

关键概念和对应的类的介绍如下:

### 系统处理流程

### 系统模块

## 实际运行效果

## 附录：理论简介

### 辐射度量学

### 色度学

### 光度学

### 蒙特卡洛积分